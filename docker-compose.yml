version: '3.8'

services:
  forge:
    build: .
    image: ghcr.io/adamwarniment/forge-webrtc:latest
    container_name: forge-webrtc
    restart: unless-stopped
    ports:
      - "8080:8080" # noVNC Web Interface
    environment:
      - TZ=${TZ:-UTC}
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - DISPLAY=:99
    volumes:
      # Map Forge user data for persistence
      # Forge saves data in ~/.local/share/forge
      - ./data/forge:/home/ubuntu/.local/share/forge
      - ./data/cache:/home/ubuntu/.cache/forge
      # Optionally map the entire home directory for full persistence
      # - ./data/home:/home/ubuntu
    shm_size: "512mb"
