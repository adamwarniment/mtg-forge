services:
  forge:
    build: .
    image: ghcr.io/adamwarniment/mtg-forge:latest
    container_name: mtg-forge
    restart: unless-stopped
    ports:
      - "8080:8080" # noVNC Web Interface
    environment:
      - TZ=${TZ:-UTC}
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - DISPLAY=:99
      - DISPLAY_WIDTH=${DISPLAY_WIDTH:-1920}
      - DISPLAY_HEIGHT=${DISPLAY_HEIGHT:-1080}
    volumes:
      # Map Forge user data for persistence
      # Forge saves data in ~/.local/share/forge
      - ${FORGE_PARENT_DIR:-./data}/data:/home/ubuntu/.local/share/forge
      - ${FORGE_PARENT_DIR:-./data}/user:/home/ubuntu/.forge
      - ${FORGE_PARENT_DIR:-./data}/cache:/home/ubuntu/.cache/forge
      # Optionally map the entire home directory for full persistence
      # - ./data/home:/home/ubuntu
    shm_size: "512mb"
